{"schemas":"DEFINE FIELD status ON subscriptions TYPE string;\nDEFINE TABLE users SCHEMAFULL;\n\nDEFINE FIELD username ON users TYPE string ASSERT $value != NONE;\nDEFINE FIELD password ON users TYPE string ASSERT $value != NONE;\nDEFINE INDEX username on TABLE users COLUMNS username UNIQUE;\nDEFINE FIELD salt ON users TYPE string ASSERT $value != NONE;\nBEGIN TRANSACTION;\nUPDATE subscriptions SET status = 'confirmed' WHERE status = NONE;\nDEFINE FIELD status ON subscriptions TYPE string ASSERT $value != NONE;\nCOMMIT TRANSACTION;\nDEFINE TABLE subscriptions SCHEMAFULL;\n\nDEFINE FIELD email ON subscriptions TYPE string ASSERT $value != NONE AND is::email($value);\nDEFINE INDEX email ON TABLE subscriptions COLUMNS email UNIQUE;\nDEFINE FIELD name ON subscriptions TYPE string ASSERT $value != NONE;\nDEFINE FIELD subscribed_at ON subscriptions TYPE datetime ASSERT $value != NONE;\nBEGIN;\nREMOVE FIELD salt ON users;\nUPDATE users SET salt = NONE;\nCOMMIT;\nDEFINE TABLE subscription_tokens SCHEMAFULL;\n\nDEFINE FIELD subscription_token ON subscription_tokens TYPE string ASSERT $value != NONE;\nDEFINE INDEX subscription_token on TABLE subscription_tokens COLUMNS subscription_token UNIQUE;\nBEGIN;\nDEFINE FIELD password_hash ON users TYPE string ASSERT $value != NONE;\nUPDATE users SET password_hash = password;\nREMOVE FIELD password ON users;\nUPDATE users;\nCOMMIT;","events":""}